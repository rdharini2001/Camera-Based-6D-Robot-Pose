import numpy as np
pts_src=np.array([[-18.5,-18.5,1],[18.5,-18.5,1],[18.5,18.5,1],[-18.5,18.5,1],[-18.5,101.5,1],[18.5,101.5,1],[18.5,138.5,1],[-18.5,138.5,1],[-18.5,221.5,1],[18.5,221.5,1],[18.5,258.5,1],[-18.5,258.5,1],[41.5,341.5,1],[78.5,341.5,1],[78.5,378.5,1],[41.5,378.5,1],[-138.5,221.5,1],[-101.5,221.5,1],[-101.5,258.5,1],[-138.5,258.5,1],[-138.5,101.5,1],[-101.5,101.5,1],[-101.5,138.5,1],[-138.5,138.5,1]])  # planar object points 
pts_dst=np.array([[663,451,1],[755,449,1],[740,388,1],[655,390,1],[636,274,1],[712,273,1],[702,234,1],[632,234,1],[620,158,1],[681,159,1],[676,133,1],[616,132,1],[693,81,1],[744,83,1],[735,64,1],[687,62,1],[421,162,1],[482,161,1],[485,133,1],[427,136,1],[392,279,1],[467,278,1],[471,236,1],[401,238,1]]) # image points
import cv2
h, status = cv2.findHomography(pts_src, pts_dst)
# print(h)


pts_src=np.array([[[-78.5],[341.5],[1]],[[-41.5],[341.5],[1]],[[-41.5],[378.5],[1]],[[-78.5],[378.5],[1]]])  # planar object points 
h=np.array([[2.59275014,1.22742257,703.045769],[0.0176127956,-0.801686794,417.718048],[0.000208861672,0.00224224441,1.00000000]])
pts_dst=np.zeros((3,1)) # image points
dst=[]
import cv2,itertools
from numpy.linalg import inv
#h=inv(h)
for pts in pts_src:
    pts_dst=np.matmul(h,pts)
    pts_dst[0]=pts_dst[0]/pts_dst[2]
    pts_dst[1]=pts_dst[1]/pts_dst[2]
    pts_dst[2]=1
    dst.append(pts_dst)
    
# print(pts_dst)
img_test=[[523],[80],[1]],[[576],[80],[1]],[[574],[61],[1]],[[525],[63],[1]]
# print(img_test)
dist=0
for pts_test,pts in zip(img_test,dst):
    # print(pts_test)
    # print()
    # print(pts)
    for p1,p2 in zip(pts_test,pts):
        #   print(p1[0],p2[0])
          dist+=pow(abs(p1[0]-p2[0]),2)
          
    print(np.sqrt(dist))
# #,[-138.5,-78.5],[-101.5,-78.5],[-101.5,-41.5],[-138.5,-41.5]             ,[-41.5,341.5,0],[-41.5,378.5,0],[-78.5,378.5,0
